# EVcouplings config for rbcL - using existing alignment

pipeline: protein_monomer

# Only run couplings and compare (alignment already exists)
stages:
    - align
    - couplings
    - compare
    # - mutate
    # - fold

global:
    prefix: results/evcouplings/rbcL
    sequence_id: rbcL
    sequence_file:
    region:
    theta: 0.8
    cpu: 4

batch:

# Using existing alignment protocol
align:
    protocol: existing
    input_alignment: data/tmp/alignedGenes/rbcL_AA_aligned_evc.fasta
    sequence_id: rbcL
    first_index: 1
    compute_num_effective_seqs: False
    theta: 0.8
    seqid_filter:
    minimum_sequence_coverage: 50
    minimum_column_coverage: 70
    extract_annotation: False

couplings:
    protocol: standard
    iterations: 100
    alphabet:
    ignore_gaps: True
    lambda_J: 0.01
    lambda_J_times_Lq: True
    lambda_h: 0.01
    lambda_group:
    scale_clusters:
    reuse_ecs: True
    min_sequence_distance: 6
    scoring_model: logistic_regression

compare:
    protocol: standard
    prefix:
    sequence_id:
    ec_file:
    target_sequence_file:
    
    # Set to True to find structures by alignment (recommended for non-UniProt IDs)
    by_alignment: True
    
    # Optionally specify PDB IDs for rbcL structures (e.g., 1RCX, 8RUC)
    # Leave blank to auto-detect via alignment
    pdb_ids: ["1RCX"]
    
    max_num_structures: 10
    max_num_hits: 25
    compare_multimer: True
    
    sequence_file:
    first_index:
    region:
    alignment_min_overlap: 20
    use_bitscores: True
    domain_threshold: 0.1
    sequence_threshold: 0.1
    
    atom_filter:
    distance_cutoff: 5
    min_sequence_distance: 6
    
    # Probability cutoffs for contact map plots
    plot_probability_cutoffs: [0.90, 0.99]
    plot_lowest_count: 0.05
    plot_highest_count: 1.0
    plot_increase: 0.05
    
    boundaries: union
    scale_sizes: True
    draw_secondary_structure: True
    draw_coverage: True
    print_pdb_information: True
    pdb_alignment_method: jackhmmer

mutate:
    protocol: standard
    mutation_dataset_file:

fold:
    protocol: standard
    engine: cns_dgsa
    folding_config_file:
    cut_to_alignment_region: True
    sec_struct_method: psipred
    reuse_sec_struct: True
    sec_struct_file:
    filter_sec_struct_clashes: True
    min_sequence_distance: 6
    fold_probability_cutoffs: [0.90, 0.99]
    fold_lowest_count: 0.5
    fold_highest_count: 1.3
    fold_increase: 0.05
    num_models: 10
    cleanup: True

management:
    database_uri:
    job_name:
    archive: [target_sequence_file, statistics_file, alignment_file, frequencies_file, ec_file, ec_longrange_file,
              model_file, enrichment_file, evzoom_file, enrichment_pml_files, ec_lines_pml_file, contact_map_files,
              ec_compared_all_file, ec_compared_longrange_file, remapped_pdb_files, mutations_epistatic_pml_files,
              mutation_matrix_file, mutation_matrix_plot_files, secondary_structure_pml_file, folding_ec_file,
              folded_structure_files, folding_ranking_file, folding_comparison_file, folding_individual_comparison_files,
              ec_lines_compared_pml_file, pdb_structure_hits_file, sec_struct_file]

environment:
    engine: local
    queue:
    cores: 4
    memory: 15000
    time:

# UPDATE THESE PATHS FOR YOUR SYSTEM
databases:
    uniprot:
    uniref100:
    uniref90:
    sequence_download_url: http://rest.uniprot.org/uniprot/{}.fasta
    pdb_mmtf_dir: data/pdb_mmtf/
    sifts_mapping_table: data/SIFTS/pdb_chain_uniprot_plus.csv
    sifts_sequence_db: data/SIFTS/pdb_chain_uniprot_plus.fasta

# UPDATE THESE PATHS FOR YOUR SYSTEM
tools:
    jackhmmer: /programs/hmmer-3.4/bin/jackhmmer
    plmc: ../plmc/plmc/bin/plmc
    hmmbuild: /programs/hmmer-3.4/bin/hmmbuild
    hmmsearch: /programs/hmmer-3.4/bin/hmmsearch
    hhfilter:
    psipred:
    cns:
    maxcluster:
